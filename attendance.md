# 考勤

> 考勤目录为 views/attendance，在科室考勤界面查看考勤列表，进行新增考勤 > 审核界面进行审核 > 审核通过之后会在已审核查看数据

- 医生、护士、科室和部分考勤都是基于医生考勤的代码，通过 attendanceType 来区分 0 护士，1医生，2科室。通过 url 上传入的 type 值来区分编辑(edit)，审核(check)，查看(view)及暂存(save)，attenceType 用来区分科室和部分人员考勤。

- 进页面新增考勤的情况要求先弹出月份选择，选择月份之后调用后台接口查本部门人员的请假信息，其他情况(查看，审核，暂存)都通过 url 上传入的dateCd 进行调用接口及设置月份

- 不论新增还是审核，开始后台会根据字典查出考勤类别(算缺勤和不算缺勤)的三个 json 内容，在 init 方法里面对数组循环做了处理改成了 leaveArr、otherArr 和 absentArr 三个数组，在页面上对其循环产生 label 文字显示和 input 输入框(**备注框进行了特殊判断，可以输入文字，其他框都只能输入数字**)。输入框逻辑在(**handleDaysoffInput**)方法上，通过输入的 type 进行区分三种数组赋值，是备注的输入框则直接赋值，其他情况赋值之后还得计算出勤天数的差值。(**请假输入的天数和其他下面的框输入的天数都要计算差值**)

- 支科可以从别的部门选择人到本部门考勤，不用提交考勤支科人员就直接新增了，返回上个页面再进来这个支科人员就直接能查出来。新增原本是调用接口新增支科人员之后再调用 init 方法重新查一遍考勤人员，但是如果之前输入框输入了值这时候会全部重置掉，所以就自己写的新增逻辑。点支科的时候会把已经在的支科人员回显回去，选择完人员之后点击确定的时候，选择人员数组与 tableData 的数组数据进行比较。
> index 的几种情况判断
  1. index 在 tableData 中已存在的不处理
  2. index 存在， tableData 中不存在的则 push 进去
  3. index 不存在， tableData 中存在的则删除掉

- 新增考勤的情况下，考勤人员不论是原部门人员还是支科人员都是可以删除的。不同的是，支科人员(**userType为1**)会调用接口删除，然后调用 splice 切除